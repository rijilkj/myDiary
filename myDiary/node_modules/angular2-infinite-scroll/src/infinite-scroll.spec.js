"use strict";
var infinite_scroll_1 = require('./infinite-scroll');
var core_1 = require('@angular/core');
describe('Infinite Scroll Directive', function () {
    // const zone = new NgZone({ enableLongStackTrace: false });
    var isScrollingDown = true;
    var zoneSpy, scrollResolverSpy, scrollRegisterSpy, positionResolverSpy;
    var positionFactoryMock = {
        create: function () { return positionResolverSpy; }
    };
    var createMockElement = function () {
        var mockedElement = new core_1.ElementRef(document.createElement('div'));
        return mockedElement;
    };
    var createInfiniteScroll = function () {
        var mockedElement = createMockElement();
        return new infinite_scroll_1.InfiniteScroll(mockedElement, zoneSpy, positionFactoryMock, scrollRegisterSpy, scrollResolverSpy);
    };
    beforeEach(function () {
        zoneSpy = jasmine.createSpyObj('zone', ['run']);
        scrollResolverSpy = {
            getScrollStats: function () {
                return { shouldScroll: true, isScrollingDown: isScrollingDown };
            }
        };
        scrollRegisterSpy = jasmine.createSpyObj('register', ['attachEvent']);
        positionResolverSpy = jasmine.createSpyObj('pos', ['create', 'container']);
    });
    it('should create an instance of the directive', function () {
        var actual = createInfiniteScroll();
        expect(actual).toBeDefined();
    });
    it('should have default @Input properties values', function () {
        var directive = createInfiniteScroll();
        var expectedInputs = {
            _distanceDown: 2,
            _distanceUp: 1.5,
            _throttle: 300,
            scrollWindow: true,
            _immediate: false,
            _horizontal: false,
            _alwaysCallback: false,
            _disabled: false
        };
        Object.keys(expectedInputs).forEach(function (input) {
            return expect(directive[input]).toEqual(expectedInputs[input]);
        });
    });
    it('should trigger the onScrollDown event when scroll has passed _distancedDown', function () {
        var directive = createInfiniteScroll();
        var container = {
            height: 0,
            scrolledUntilNow: 0,
            totalToScroll: 0,
        };
        spyOn(directive, 'onScrollDown');
        directive.ngOnInit();
        directive.handleOnScroll(container);
        var actual = directive.onScrollDown;
        expect(actual).toHaveBeenCalled();
    });
    it('should trigger the onScrollUp event when scroll has passed _distanceUp', function () {
        var directive = createInfiniteScroll();
        var container = {
            height: 0,
            scrolledUntilNow: 0,
            totalToScroll: 0,
        };
        spyOn(directive, 'onScrollUp');
        directive.ngOnInit();
        isScrollingDown = false;
        directive.handleOnScroll(container);
        var actual = directive.onScrollUp;
        expect(actual).toHaveBeenCalled();
    });
    it('should disable the scroller', function () {
        var directive = createInfiniteScroll();
        var container = {
            height: 0,
            scrolledUntilNow: 0,
            totalToScroll: 0,
        };
        spyOn(directive, 'onScrollDown');
        directive.ngOnInit();
        directive._disabled = true;
        directive.handleOnScroll(container);
        var actual = directive.onScrollDown;
        expect(actual).not.toHaveBeenCalled();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5maW5pdGUtc2Nyb2xsLnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmZpbml0ZS1zY3JvbGwuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBSUEsZ0NBQStCLG1CQUFtQixDQUFDLENBQUE7QUFNbkQscUJBQWdFLGVBQWUsQ0FBQyxDQUFBO0FBRWhGLFFBQVEsQ0FBQywyQkFBMkIsRUFBRTtJQUNwQyw0REFBNEQ7SUFDNUQsSUFBSSxlQUFlLEdBQUcsSUFBSSxDQUFDO0lBQzNCLElBQUksT0FBWSxFQUFFLGlCQUFzQixFQUFFLGlCQUFzQixFQUFFLG1CQUF3QixDQUFDO0lBQzNGLElBQU0sbUJBQW1CLEdBQVM7UUFDaEMsTUFBTSxFQUFFLGNBQU0sT0FBQSxtQkFBbUIsRUFBbkIsQ0FBbUI7S0FDbEMsQ0FBQztJQUNGLElBQU0saUJBQWlCLEdBQUc7UUFDeEIsSUFBTSxhQUFhLEdBQWUsSUFBSSxpQkFBVSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUNoRixNQUFNLENBQUMsYUFBYSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQztJQUNGLElBQU0sb0JBQW9CLEdBQUc7UUFDM0IsSUFBTSxhQUFhLEdBQUcsaUJBQWlCLEVBQUUsQ0FBQztRQUMxQyxNQUFNLENBQUMsSUFBSSxnQ0FBYyxDQUN2QixhQUFhLEVBQ2IsT0FBTyxFQUNQLG1CQUFtQixFQUNuQixpQkFBaUIsRUFDakIsaUJBQWlCLENBQ2xCLENBQUM7SUFDSixDQUFDLENBQUM7SUFFRixVQUFVLENBQUM7UUFDVCxPQUFPLEdBQUcsT0FBTyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ2hELGlCQUFpQixHQUFHO1lBQ2xCLGNBQWMsRUFBRTtnQkFDZCxNQUFNLENBQUMsRUFBRSxZQUFZLEVBQUUsSUFBSSxFQUFFLGdDQUFlLEVBQUUsQ0FBQztZQUNqRCxDQUFDO1NBQ0YsQ0FBQztR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U0FBUyxHQUFHLElBQUksQ0FBQztRQUMzQixTQUFTLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3BDLElBQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxZQUFZLENBQUM7UUFDdEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBhc3luYyxcbiAgaW5qZWN0XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7XG5pbXBvcnQgeyBJbmZpbml0ZVNjcm9sbCB9IGZyb20gJy4vaW5maW5pdGUtc2Nyb2xsJztcbmltcG9ydCB7IEF4aXNSZXNvbHZlckZhY3RvcnkgfSBmcm9tICcuL2F4aXMtcmVzb2x2ZXInO1xuaW1wb3J0IHsgUG9zaXRpb25SZXNvbHZlckZhY3RvcnkgfSBmcm9tICcuL3Bvc2l0aW9uLXJlc29sdmVyJztcbmltcG9ydCB7IFNjcm9sbFJlZ2lzdGVyIH0gZnJvbSAnLi9zY3JvbGwtcmVnaXN0ZXInO1xuaW1wb3J0IHsgU2Nyb2xsUmVzb2x2ZXIgfSBmcm9tICcuL3Njcm9sbC1yZXNvbHZlcic7XG5cbmltcG9ydCB7IEVsZW1lbnRSZWYsIE5nWm9uZSwgU2ltcGxlQ2hhbmdlcywgU2ltcGxlQ2hhbmdlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmRlc2NyaWJlKCdJbmZpbml0ZSBTY3JvbGwgRGlyZWN0aXZlJywgKCkgPT4ge1xuICAvLyBjb25zdCB6b25lID0gbmV3IE5nWm9uZSh7IGVuYWJsZUxvbmdTdGFja1RyYWNlOiBmYWxzZSB9KTtcbiAgbGV0IGlzU2Nyb2xsaW5nRG93biA9IHRydWU7XG4gIGxldCB6b25lU3B5OiBhbnksIHNjcm9sbFJlc29sdmVyU3B5OiBhbnksIHNjcm9sbFJlZ2lzdGVyU3B5OiBhbnksIHBvc2l0aW9uUmVzb2x2ZXJTcHk6IGFueTtcbiAgY29uc3QgcG9zaXRpb25GYWN0b3J5TW9jazogYW55ID0gIHtcbiAgICBjcmVhdGU6ICgpID0+IHBvc2l0aW9uUmVzb2x2ZXJTcHlcbiAgfTtcbiAgY29uc3QgY3JlYXRlTW9ja0VsZW1lbnQgPSAoKSA9PiB7XG4gICAgY29uc3QgbW9ja2VkRWxlbWVudDogRWxlbWVudFJlZiA9IG5ldyBFbGVtZW50UmVmKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKTtcbiAgICByZXR1cm4gbW9ja2VkRWxlbWVudDtcbiAgfTtcbiAgY29uc3QgY3JlYXRlSW5maW5pdGVTY3JvbGwgPSAoKSA9PiB7XG4gICAgY29uc3QgbW9ja2VkRWxlbWVudCA9IGNyZWF0ZU1vY2tFbGVtZW50KCk7XG4gICAgcmV0dXJuIG5ldyBJbmZpbml0ZVNjcm9sbChcbiAgICAgIG1vY2tlZEVsZW1lbnQsXG4gICAgICB6b25lU3B5LFxuICAgICAgcG9zaXRpb25GYWN0b3J5TW9jayxcbiAgICAgIHNjcm9sbFJlZ2lzdGVyU3B5LFxuICAgICAgc2Nyb2xsUmVzb2x2ZXJTcHlcbiAgICApO1xuICB9O1xuXG4gIGJlZm9yZUVhY2goKCkgPT57XG4gICAgem9uZVNweSA9IGphc21pbmUuY3JlYXRlU3B5T2JqKCd6b25lJywgWydydW4nXSk7XG4gICAgc2Nyb2xsUmVzb2x2ZXJTcHkgPSB7XG4gICAgICBnZXRTY3JvbGxTdGF0czogKCkgPT4ge1xuICAgICAgICByZXR1cm4geyBzaG91bGRTY3JvbGw6IHRydWUsIGlzU2Nyb2xsaW5nRG93biB9O1xuICAgICAgfVxuICAgIH07XG4gICAgc2Nyb2xsUmVnaXN0ZXJTcHkgPSBqYXNtaW5lLmNyZWF0ZVNweU9iaigncmVnaXN0ZXInLCBbJ2F0dGFjaEV2ZW50J10pXG4gICAgcG9zaXRpb25SZXNvbHZlclNweSA9IGphc21pbmUuY3JlYXRlU3B5T2JqKCdwb3MnLCBbJ2NyZWF0ZScsICdjb250YWluZXInXSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgY3JlYXRlIGFuIGluc3RhbmNlIG9mIHRoZSBkaXJlY3RpdmUnLCAoKSA9PiB7XG4gICAgY29uc3QgYWN0dWFsID0gY3JlYXRlSW5maW5pdGVTY3JvbGwoKTtcbiAgICBleHBlY3QoYWN0dWFsKS50b0JlRGVmaW5lZCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhdmUgZGVmYXVsdCBASW5wdXQgcHJvcGVydGllcyB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgZGlyZWN0aXZlID0gY3JlYXRlSW5maW5pdGVTY3JvbGwoKTtcbiAgICBjb25zdCBleHBlY3RlZElucHV0cyA9IHtcbiAgICAgIF9kaXN0YW5jZURvd246IDIsXG4gICAgICBfZGlzdGFuY2VVcDogMS41LFxuICAgICAgX3Rocm90dGxlOiAzMDAsXG4gICAgICBzY3JvbGxXaW5kb3c6IHRydWUsXG4gICAgICBfaW1tZWRpYXRlOiBmYWxzZSxcbiAgICAgIF9ob3Jpem9udGFsOiBmYWxzZSxcbiAgICAgIF9hbHdheXNDYWxsYmFjazogZmFsc2UsXG4gICAgICBfZGlzYWJsZWQ6IGZhbHNlXG4gICAgfTtcblxuICAgIE9iamVjdC5rZXlzKGV4cGVjdGVkSW5wdXRzKS5mb3JFYWNoKGlucHV0ID0+XG4gICAgICBleHBlY3QoZGlyZWN0aXZlW2lucHV0XSkudG9FcXVhbChleHBlY3RlZElucHV0c1tpbnB1dF0pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCB0cmlnZ2VyIHRoZSBvblNjcm9sbERvd24gZXZlbnQgd2hlbiBzY3JvbGwgaGFzIHBhc3NlZCBfZGlzdGFuY2VkRG93bicsICgpID0+IHtcbiAgICBjb25zdCBkaXJlY3RpdmUgPSBjcmVhdGVJbmZpbml0ZVNjcm9sbCgpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHtcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIHNjcm9sbGVkVW50aWxOb3c6IDAsXG4gICAgICB0b3RhbFRvU2Nyb2xsOiAwLFxuICAgIH1cbiAgICBzcHlPbihkaXJlY3RpdmUsICdvblNjcm9sbERvd24nKTtcbiAgICBkaXJlY3RpdmUubmdPbkluaXQoKTtcbiAgICBkaXJlY3RpdmUuaGFuZGxlT25TY3JvbGwoY29udGFpbmVyKVxuICAgIGNvbnN0IGFjdHVhbCA9IGRpcmVjdGl2ZS5vblNjcm9sbERvd247XG4gICAgZXhwZWN0KGFjdHVhbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHRyaWdnZXIgdGhlIG9uU2Nyb2xsVXAgZXZlbnQgd2hlbiBzY3JvbGwgaGFzIHBhc3NlZCBfZGlzdGFuY2VVcCcsICgpID0+IHtcbiAgICBjb25zdCBkaXJlY3RpdmUgPSBjcmVhdGVJbmZpbml0ZVNjcm9sbCgpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHtcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIHNjcm9sbGVkVW50aWxOb3c6IDAsXG4gICAgICB0b3RhbFRvU2Nyb2xsOiAwLFxuICAgIH07XG4gICAgc3B5T24oZGlyZWN0aXZlLCAnb25TY3JvbGxVcCcpO1xuICAgIGRpcmVjdGl2ZS5uZ09uSW5pdCgpO1xuICAgIGlzU2Nyb2xsaW5nRG93biA9IGZhbHNlO1xuICAgIGRpcmVjdGl2ZS5oYW5kbGVPblNjcm9sbChjb250YWluZXIpO1xuICAgIGNvbnN0IGFjdHVhbCA9IGRpcmVjdGl2ZS5vblNjcm9sbFVwO1xuICAgIGV4cGVjdChhY3R1YWwpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkaXNhYmxlIHRoZSBzY3JvbGxlcicsICgpID0+IHtcbiAgICBjb25zdCBkaXJlY3RpdmUgPSBjcmVhdGVJbmZpbml0ZVNjcm9sbCgpO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHtcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIHNjcm9sbGVkVW50aWxOb3c6IDAsXG4gICAgICB0b3RhbFRvU2Nyb2xsOiAwLFxuICAgIH1cbiAgICBzcHlPbihkaXJlY3RpdmUsICdvblNjcm9sbERvd24nKTtcbiAgICBkaXJlY3RpdmUubmdPbkluaXQoKTtcbiAgICBkaXJlY3RpdmUuX2Rpc2FibGVkID0gdHJ1ZTtcbiAgICBkaXJlY3RpdmUuaGFuZGxlT25TY3JvbGwoY29udGFpbmVyKTtcbiAgICBjb25zdCBhY3R1YWwgPSBkaXJlY3RpdmUub25TY3JvbGxEb3duO1xuICAgIGV4cGVjdChhY3R1YWwpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xufSlcblxuaW50ZXJmYWNlIERlY29yYXRvckludm9jYXRpb24ge1xuICB0eXBlOiBGdW5jdGlvbjtcbiAgYXJncz86IGFueVtdO1xufVxuIl19